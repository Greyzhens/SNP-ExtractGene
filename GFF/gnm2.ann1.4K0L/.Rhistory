View(data)
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr = grep(name,data$V1)
wname = paste0(name,"ann1.CCJH.txt")
fwrite(chr,wname)
chr
count = 1
for (x in 1:20) {
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr[grep(name,data$V1), ]
wname = paste0(name,".CCJH.txt")
fwrite(chr,wname)
print(paste0(wname," done. ",count,"/20"))
count = count + 1
}
count = 1
for (x in 1:20) {
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr = data
chr[grep(name,data$V1), ]
wname = paste0(name,".CCJH.txt")
fwrite(chr,wname)
print(paste0(wname," done. ",count,"/20"))
count = count + 1
}
library(data.table)
setwd("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm1.ann1.CCJH/")
getwd
data=fread("CCJH.gff3",header = F)
chrname=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
#
count = 1
for (x in 1:20) {
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr = data
chr[grep(name,data$V1), ]
wname = paste0(name,".CCJH.txt")
fwrite(chr,wname,col.names=NA)
print(paste0(wname," done. ",count,"/20"))
count = count + 1
}
count = 1
for (x in 1:20) {
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr = data
chr[grep(name,data$V1), ]
wname = paste0(name,".CCJH.txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," done. ",count,"/20"))
count = count + 1
}
count = 1
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr = data
chr = chr[grep(name,data$V1), ]
View(chr)
library(data.table)
setwd("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm1.ann1.CCJH/")
getwd
data=fread("CCJH.gff3",header = F)
chrname=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
#
count = 1
for (x in 1:20) {
name = paste0("arahy.Tifrunner.gnm1.Arahy.",chrname[count])
chr = data
chr = chr[grep(name,data$V1), ]
wname = paste0(name,".CCJH.txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," done. ",count,"/20"))
count = count + 1
}
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm1.ann1.CCJH/")
filename=("CCJH.gff3")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm1.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
data=fread(filename,header = F)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split()
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm1.ann1.CCJH/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename)
data=readLines(gz_file)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split_Chr()
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm2.ann1.4K0L/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename)
data=readLines(gz_file)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split_Chr()
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm2.ann1.4K0L/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename)
data=readLines(gz_file)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
gz_file = gzfile(filename)
gz_file = gzfile(filename,"rb")
data=readLines(gz_file)
data
data=as.data.frame(data)
View(data)
grayzhens = sub("\\.[^.]+$", "", filename)
grayzhens = sub("\\.[^.]*$", "", filename)
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm2.ann1.4K0L/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename,"rb")
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
data=fread(grayzhens)
file.remove(grayzhens)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split_Chr()
gz_file = gzfile(filename,"rb")
gz_file = gzfile(filename)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
gz_file = gzfile(filename)
gz_file = as.data.frame(gz_file)
class(gz_file)
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
gz_file = as.data.frame(gz_file)
gz_file = gzfile(filename)
gz_file = gzfile(filename)
gz_file = read.table(gz_file)
gz_file = readLines(gz_file)
gz_file = gzfile(filename)
gz_file = readLines(gz_file)
gz_file = as.data.frame(gz_file)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
data=fread(grayzhens)
View(data)
View(data)
gz_file
head(gz_file)
gz_file = gz_file[-(1:3),]
head(gz_file)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
gz_file = as.data.frame(gz_file)
fwrite(gz_file,grayzhens)
data=fread(grayzhens)
View(data)
file.remove(grayzhens)
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm2.ann1.4K0L/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename)
gz_file = readLines(gz_file)
gz_file = as.data.frame(gz_file)
gz_file = gz_file[-(1:3),]
gz_file = as.data.frame(gz_file)
head(gz_file)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
data=fread(grayzhens)
file.remove(grayzhens)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split_Chr()
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm2.ann1.4K0L/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename)
gz_file = readLines(gz_file)
gz_file = as.data.frame(gz_file)
gz_file = gz_file[-(1:3),]
gz_file = as.data.frame(gz_file)
head(gz_file)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
data=suppressWarnings(fread(grayzhens))
file.remove(grayzhens)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split_Chr()
gz_file = gzfile(filename)
gz_file = readLines(gz_file)
gz_file = as.data.frame(gz_file)
gz_file = gz_file[-(1:3),]
gz_file = as.data.frame(gz_file)
head(gz_file)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
data=suppressWarnings(fread(grayzhens))
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$V1), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
View(data)
View(chr)
chr = data
chr = chr[grep(name,chr$V1), ]
View(data)
wd=("/Users/ningdongzhen/Desktop/Github/SNP-ExtractGene/GFF/gnm2.ann1.4K0L/")
filename=("4K0L.gff3.gz")
#例：arahy.Tifrunner.gnm1.Arahy.x，chr1为"arahy.Tifrunner.gnm1.Arahy."。chr2为"x"
chr1=("arahy.Tifrunner.gnm2.Arahy.")
chr2=c("01","02","03","04","05",
"06","07","08","09","10",
"11","12","13","14","15",
"16","17","18","19","20")
GFF3_split_Chr = function() {
#包
library(data.table)
#设置路径
setwd(wd)
#读取gff文件
gz_file = gzfile(filename)
gz_file = readLines(gz_file)
gz_file = as.data.frame(gz_file)
gz_file = gz_file[-(1:3),]
gz_file = as.data.frame(gz_file)
head(gz_file)
grayzhens = sub("\\.[^.]*$", "", filename)
fwrite(gz_file,grayzhens)
data=suppressWarnings(fread(grayzhens))
file.remove(grayzhens)
#循环部分
count = 1
for (x in 1:20) {
name = paste0(chr1,chr2[count])
chr = data
chr = chr[grep(name,chr$gz_file), ]
wname = paste0(name,".txt")
fwrite(chr,wname,col.names= FALSE)
print(paste0(wname," has been completed. Process ",count,"/20"))
count = count + 1
}
}
GFF3_split_Chr()
source("/Volumes/Grayzhens/主线任务/基因家族/EFhand(3)/All.R")
library(data.table)
mainlist = ("/Users/ningdongzhen/Desktop/test/765.fa",header  = F)
library(data.table)
mainlist = fread("/Users/ningdongzhen/Desktop/test/765.fa",header  = F)
View(mainlist)
x =  grep(">", mainlist)
x =  mainlist[grep(">", mainlist)]
x =  mainlist[grep(">", mainlist)]
nrow(mainlist)
x =  mainlist[grep(">arahy.Tifrunner.gnm2.ann1", mainlist)]
x =  mainlist[grep(">arahy.Tifrunner.gnm2.ann1", mainlist$V1)]
class(x)
more(x)
head(x)
x = as.data.frame(x)
View(x)
mainlist = fread("/Users/ningdongzhen/Desktop/test/765.fa",header  = F)
mainlist =  as.data.frame(mainlist[grep(">arahy.Tifrunner.gnm2.ann1", mainlist$V1)])
View(mainlist)
library(data.table)
mainlist = fread("/Users/ningdongzhen/Desktop/test/765.fa",header  = F)
mainlist =  as.data.frame(mainlist[grep(">arahy.Tifrunner.gnm2.ann1", mainlist$V1)])
aimlist = fread("/Users/ningdongzhen/Desktop/test/Ca.csv",header = F)
View(aimlist)
aimlist = fread("/Users/ningdongzhen/Desktop/test/Ca.csv",header = T)
nrow(aimlist$Ca11)
nrow(aimlist)
Chr11 = data.frame(matrix(0, nrow = 121, ncol = 4))
View(Chr11)
title = c("Ca11","count","Ca18","count")
Result = data.frame(matrix(0, nrow = 121, ncol = 4))
title = c("Ca11","count","Ca18","count")
colname(Result) = title
View(Result)
Result = data.frame(matrix(0, nrow = 121, ncol = 4))
title = c("Ca11","count","Ca18","count")
rowname(Result) = title
colnames(Result) = title
Result = data.frame(matrix(0, nrow = 121, ncol = 4))
title = c("Ca11","count11","Ca18","count18")
colnames(Result) = title
for (x in 1:40) {
count = grepl(aimlist$Ca11[x],mainlist$V1)
count = nrow(count)
Result$count11[x] = count
}
count = grepl(aimlist$Ca11[1],mainlist$V1)
count = nrow(count)
Result$count11[1] = count
for (x in 1:40) {
count = grepl(aimlist$Ca11[x],mainlist$V1)
count = nrow(count)
if (count = NULL) {
for (x in 1:40) {
count = grepl(aimlist$Ca11[x],mainlist$V1)
count = nrow(count)
if (count == NULL) {
x = x+1
}
Result$count11[x] = count
}
num = 1
for (x in 1:40) {
count = grepl(aimlist$Ca11[num],mainlist$V1)
count = nrow(count)
if (is.null(count)) {
num = num + 1
}else{
Result$count11[num] = count
num = num + 1
}
}
num = 1
for (x in 1:40) {
count = grepl(aimlist$Ca11[num],mainlist$V1)
count = nrow(count)
if (is.null(count)) {
Result$Ca11[num] = aimlist$Ca11[num]
num = num + 1
}else{
Result$count11[num] = count
num = num + 1
}
}
#18
num18 = 1
for (x in 1:121) {
count = grepl(aimlist$Ca11[num18],mainlist$V1)
count = nrow(count)
if (is.null(count)) {
Result$Ca11[num18] = aimlist$Ca11[num18]
num18 = num18 + 1
}else{
Result$count11[num18] = count
num18 = num18 + 1
}
}
num18 = 1
for (x in 1:121) {
count = grepl(aimlist$Ca18[num18],mainlist$V1)
count = nrow(count)
if (is.null(count)) {
Result$Ca18[num18] = aimlist$Ca18[num18]
num18 = num18 + 1
}else{
Result$count18[num18] = count
num18 = num18 + 1
}
}
